<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>{{ title or "Failover Dashboard" }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS global du dashboard -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- JS (optionnel) -->
    <script src="{{ url_for('static', filename='js/main.js') }}" defer></script>

    <style>
      /* Quelques petits complÃ©ments qui s'appuient sur ton style.css existant */

      .container {
          max-width: 980px;
          margin: 0 auto;
      }

      nav {
          display: flex;
          flex-wrap: wrap;
          gap: 8px;
          align-items: center;
      }

      nav a {
          padding: 6px 10px;
          border-radius: 6px;
          text-decoration: none;
          font-size: 0.9em;
          border: 1px solid transparent;
      }

      nav a:hover {
          background: rgba(88,166,255,0.1);
      }

      nav a.active {
          color: var(--accent);
          border-color: var(--accent);
          background: rgba(88,166,255,0.15);
      }

      .topbar-left {
          font-weight: 600;
      }

      .topbar-user {
          font-size: 0.85em;
          color: var(--muted);
      }
    </style>
</head>
<body>

<header class="topbar">
    <div class="topbar-left">
        Failover-Pi Dashboard
        {% if session.get("user") %}
            <span class="topbar-user">
                â€” connectÃ© : <strong>{{ session["user"]["username"] }}</strong>
                ({{ session["user"]["role"] }})
            </span>
        {% endif %}
    </div>

    <nav>
        {% set endpoint = request.endpoint %}
        {% set user = session.get("user") %}
        {% set role = user["role"] if user else "" %}
        {% set is_admin = (role == "admin") %}

        <a href="{{ url_for('index') }}"
           class="{% if endpoint == 'index' %}active{% endif %}">
           ğŸ  Dashboard
        </a>

        {# Liens rÃ©servÃ©s aux admins #}
        {% if is_admin %}
            <a href="{{ url_for('backup') }}"
               class="{% if endpoint == 'backup' %}active{% endif %}">
               ğŸ’¾ Backups
            </a>

            <a href="{{ url_for('edit_config') }}"
               class="{% if endpoint == 'edit_config' %}active{% endif %}">
               âš™ï¸ Config
            </a>

            <a href="{{ url_for('diagnostics') }}"
               class="{% if endpoint == 'diagnostics' %}active{% endif %}">
               ğŸ” Diagnostics
            </a>

            <a href="{{ url_for('users') }}"
               class="{% if endpoint == 'users' %}active{% endif %}">
               ğŸ‘¥ Utilisateurs
            </a>
        {% endif %}

        {# Liens communs Ã  tous les utilisateurs connectÃ©s #}
        {% if user %}
            <a href="{{ url_for('account') }}"
               class="{% if endpoint == 'account' %}active{% endif %}">
               ğŸ” Compte
            </a>
            <a href="{{ url_for('logout') }}">
               ğŸšª DÃ©connexion
            </a>
        {% endif %}
    </nav>
</header>

<main class="container">
    {% block content %}{% endblock %}
</main>

</body>
</html>
